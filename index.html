<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wedding Invitation</title>
	<link rel="icon" type="image/x-icon" href="assets/images/favicon.png">
	<!-- Font Awesome -->
	<script src="https://kit.fontawesome.com/dce09b9dbf.js"></script>

	<style>
		html,
		body {
			margin: 0;
			padding: 0;
			height: 100%;
			overflow: hidden;
		}

		#content-frame {
			width: 100vw;
			height: 100vh;
			border: 0;
			position: fixed;
			top: 0;
			left: 0;
		}

		#audio-controller {
			position: fixed;
			top: 20px;
			left: 20px;
			display: flex;
			align-items: center;
			gap: 10px;
			opacity: 0;
			transition: all 0.5s ease;
			z-index: 999999;
		}

		#audio-lottie {
			width: 60px;
			height: 60px;
		}

		#audio-controller #muteBtn {
			background-color: transparent;
			color: #fff;
			border: none;
			font-size: 16px;
			cursor: pointer;
		}

		#video-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			background: black;
			display: none;
			justify-content: center;
			align-items: center;
			z-index: 999999999;
		}

		#video-overlay video {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}
	</style>

</head>

<body>
	<div id="video-overlay">
		<video id="preloaderVideo" playsinline preload="auto">
			<source src="assets/videos/preloader.mp4" type="video/mp4">
		</video>
	</div>


	<iframe id="music-frame" src="music-player.html" style="display:none;"></iframe>

	<iframe id="content-frame" src="front.html" frameborder="0"></iframe>

	<div id="audio-controller">
		<div id="audio-lottie">
			<lottie-player id="audioAnim" src="https://lottie.host/dad518ee-a19b-4c1a-bb99-1f51249f7013/GZvTgHO03w.json"
				background="transparent" speed="1" autoplay loop></lottie-player>
		</div>

		<button id="muteBtn"><i class="fa-solid fa-play"></i></button>
	</div>
	<!-- Lottie -->
	<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
	<script>
		// function openInvitation() {
		// 	document.getElementById("content-frame").src = "invitation.html";
		// }

		function openInvitation() {
			const overlay = document.getElementById("video-overlay");
			const video = document.getElementById("preloaderVideo");

			// Show overlay
			overlay.style.display = "flex";

			// Restart from beginning
			video.currentTime = 0;

			// Play smoothly
			video.play().catch(() => { });

			// When video finishes → show invitation
			video.onended = () => {
				document.getElementById("content-frame").src = "invitation.html";

				// Optional fade-out
				setTimeout(() => {
					overlay.style.display = "none";
				}, 300);
			};
		}


		function openFront() {
			document.getElementById("content-frame").src = "front.html";
		}

		let isPaused = false;

		function getAudio() {
			const frame = document.getElementById("music-frame");
			return frame.contentWindow.document.getElementById("bg-music");
		}

		function getLottie() {
			return document.getElementById("audioAnim");
		}

		function startMusic() {
			document.getElementById("muteBtn").innerHTML = '<i class="fa-solid fa-play"></i>';
			const audio = getAudio();
			const lottie = getLottie();
			if (!audio) return;

			audio.volume = 1;
			audio.muted = false;
			audio.play().catch(() => { });
			lottie.play();

			document.getElementById("audio-controller").style.opacity = 1;
		}

		// Smooth fade in/out
		function fadeVolume(audio, targetVolume, duration = 700, callback = () => { }) {
			const steps = 20;
			const interval = duration / steps;
			const volumeStep = (targetVolume - audio.volume) / steps;

			let currentStep = 0;

			const fade = setInterval(() => {
				currentStep++;
				audio.volume = Math.min(1, Math.max(0, audio.volume + volumeStep));

				if (currentStep >= steps) {
					clearInterval(fade);
					callback();
				}
			}, interval);
		}

		document.getElementById("muteBtn").addEventListener("click", function () {
			const audio = getAudio();
			const lottie = getLottie();
			if (!audio) return;

			isPaused = !isPaused;

			// PAUSE logic
			if (isPaused) {
				this.innerHTML = '<i class="fa-solid fa-pause"></i>';

				// Smooth fade-out → pause audio → pause Lottie
				fadeVolume(audio, 0, 700, () => {
					audio.pause();
					lottie.pause();
				});
			}

			// PLAY logic
			else {
				this.innerHTML = '<i class="fa-solid fa-play"></i>';

				audio.volume = 0;
				audio.play().catch(() => { });
				fadeVolume(audio, 1, 700);

				// Resume Lottie animation
				lottie.play();
			}
		});
	</script>





</body>

</html>